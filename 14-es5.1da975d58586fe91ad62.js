function _defineProperties(e,n){for(var t=0;t<n.length;t++){var l=n[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}function _createClass(e,n,t){return n&&_defineProperties(e.prototype,n),t&&_defineProperties(e,t),e}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{DShy:function(e,n,t){"use strict";t.r(n);var l=t("8Y7J"),r=function e(){_classCallCheck(this,e)},u=t("pMnS"),o=t("MKJQ"),i=t("sZkV"),s=t("SVse"),a=t("mrSG"),c=t("IheW"),h=t("qXBG"),b=t("AytR"),m=t("VdwR"),f=t("qfBg"),p=t("B68i"),d=function(){function e(n,t,l,r,u,o,i,s,a,h){var m=this;_classCallCheck(this,e),this.authService=n,this.gameService=t,this.userService=l,this.http=r,this.router=o,this.activatedRoute=i,this.alertController=s,this.toastController=a,this.socket=h,this.API_URL=b.a.API_URL_DEV,this.http=new c.c(u),i.params.subscribe((function(e){m.init()}))}return _createClass(e,[{key:"ngOnInit",value:function(){}},{key:"init",value:function(){return a.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.authService.getLoggedUser().userId;case 2:return this.userId=e.sent,this.roomCode=this.activatedRoute.snapshot.paramMap.get("code"),e.next=6,this.gameService.getGameByCode(this.roomCode);case 6:if(this.room=e.sent,this.players=this.room.players,this.owner=this.room.owner.userId==this.userId,e.t0=this.room.players.some((function(e){return e.userId==n.userId})),e.t0){e.next=18;break}return e.next=13,this.gameService.addUserToGame(this.room.gameId,this.userId);case 13:return e.t1=this.players,e.next=16,this.userService.getSafeInfoUser(this.userId);case 16:e.t2=e.sent,e.t1.push.call(e.t1,e.t2);case 18:this.socket.emit("joinLobby",this.authService.getLoggedUser().userId,this.roomCode),this.socket.fromEvent("joinLobby").subscribe((function(e){return a.__awaiter(n,void 0,void 0,regeneratorRuntime.mark((function n(){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.userService.getSafeInfoUser(e);case 2:t=n.sent,this.players.some((function(e){return e.userId==t.userId}))||this.players.push(t);case 4:case"end":return n.stop()}}),n,this)})))})),this.socket.fromEvent("quitGame").subscribe((function(e){return a.__awaiter(n,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:this.players=this.players.filter((function(n){return n.userId!==e}));case 1:case"end":return n.stop()}}),n,this)})))})),this.socket.fromEvent("killGame").subscribe((function(e){return a.__awaiter(n,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.authService.getLoggedUser().role==p.a.guest,!e.t0){e.next=5;break}return e.next=4,this.userService.deleteGuest(this.authService.getLoggedUser().userId);case 4:this.authService.clearStorage();case 5:this.router.navigate(["/homepage/"]);case 6:case"end":return e.stop()}}),e,this)})))})),this.socket.fromEvent("startGame").subscribe((function(e){return a.__awaiter(n,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.router.navigateByUrl("/game/"+this.roomCode);case 1:case"end":return e.stop()}}),e,this)})))}));case 23:case"end":return e.stop()}}),e,this)})))}},{key:"exitRoom",value:function(){return a.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gameService.removeUserToGame(this.room.gameId,this.userId);case 2:if(e.t0=this.authService.getLoggedUser().role==p.a.guest,!e.t0){e.next=7;break}return e.next=6,this.userService.deleteGuest(this.authService.getLoggedUser().userId);case 6:this.authService.clearStorage();case 7:this.socket.emit("quitGame",this.userId,this.roomCode),this.router.navigate(["/homepage/"]);case 9:case"end":return e.stop()}}),e,this)})))}},{key:"deleteRoom",value:function(){return a.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gameService.deleteGame(this.room.gameId);case 2:this.socket.emit("killGame",this.roomCode),this.router.navigate(["/homepage/"]);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"startRoom",value:function(){return a.__awaiter(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.gameService.startGame(this.room.gameId);case 2:this.socket.emit("startGame",this.roomCode),this.router.navigateByUrl("/game/"+this.roomCode);case 4:case"end":return e.stop()}}),e,this)})))}}]),e}(),g=t("iInd"),v=t("RH9n"),k=l.nb({encapsulation:0,styles:[[""]],data:{}});function w(e){return l.Ib(0,[(e()(),l.pb(0,0,null,null,1,"button",[],null,[[null,"click"]],(function(e,n,t){var l=!0;return"click"===n&&(l=!1!==e.component.startRoom()&&l),l}),null,null)),(e()(),l.Hb(-1,null,["Start room"]))],null,null)}function I(e){return l.Ib(0,[(e()(),l.pb(0,0,null,null,1,"button",[],null,[[null,"click"]],(function(e,n,t){var l=!0;return"click"===n&&(l=!1!==e.component.deleteRoom()&&l),l}),null,null)),(e()(),l.Hb(-1,null,["Delete room"]))],null,null)}function y(e){return l.Ib(0,[(e()(),l.pb(0,0,null,null,1,"button",[],null,[[null,"click"]],(function(e,n,t){var l=!0;return"click"===n&&(l=!1!==e.component.exitRoom()&&l),l}),null,null)),(e()(),l.Hb(-1,null,["Exit room"]))],null,null)}function x(e){return l.Ib(0,[(e()(),l.pb(0,0,null,null,2,"div",[],null,null,null,null,null)),(e()(),l.pb(1,0,null,null,1,"div",[],null,null,null,null,null)),(e()(),l.Hb(2,null,["",""]))],null,(function(e,n){e(n,2,0,n.context.$implicit.name)}))}function R(e){return l.Ib(0,[(e()(),l.pb(0,0,null,null,4,"ion-card",[],null,null,null,o.x,o.c)),l.ob(1,49152,null,0,i.l,[l.h,l.k,l.x],null,null),(e()(),l.pb(2,0,null,0,2,"ion-card-content",[],null,null,null,o.w,o.d)),l.ob(3,49152,null,0,i.m,[l.h,l.k,l.x],null,null),(e()(),l.Hb(4,0,[" "," "]))],null,(function(e,n){e(n,4,0,n.context.$implicit.username)}))}function S(e){return l.Ib(0,[(e()(),l.pb(0,0,null,null,19,"ion-content",[],null,null,null,o.z,o.f)),l.ob(1,49152,null,0,i.t,[l.h,l.k,l.x],null,null),(e()(),l.pb(2,0,null,0,1,"div",[],null,null,null,null,null)),(e()(),l.Hb(3,null,["Lobby : ",""])),(e()(),l.eb(16777216,null,0,1,null,w)),l.ob(5,16384,null,0,s.j,[l.M,l.J],{ngIf:[0,"ngIf"]},null),(e()(),l.eb(16777216,null,0,1,null,I)),l.ob(7,16384,null,0,s.j,[l.M,l.J],{ngIf:[0,"ngIf"]},null),(e()(),l.eb(16777216,null,0,1,null,y)),l.ob(9,16384,null,0,s.j,[l.M,l.J],{ngIf:[0,"ngIf"]},null),(e()(),l.pb(10,0,null,0,2,"div",[],null,null,null,null,null)),(e()(),l.pb(11,0,null,null,0,"br",[],null,null,null,null,null)),(e()(),l.Hb(-1,null,["Packs :"])),(e()(),l.eb(16777216,null,0,1,null,x)),l.ob(14,278528,null,0,s.i,[l.M,l.J,l.q],{ngForOf:[0,"ngForOf"]},null),(e()(),l.pb(15,0,null,0,2,"div",[],null,null,null,null,null)),(e()(),l.pb(16,0,null,null,0,"br",[],null,null,null,null,null)),(e()(),l.Hb(-1,null,["Players :"])),(e()(),l.eb(16777216,null,0,1,null,R)),l.ob(19,278528,null,0,s.i,[l.M,l.J,l.q],{ngForOf:[0,"ngForOf"]},null)],(function(e,n){var t=n.component;e(n,5,0,t.owner&&t.players.length>=1),e(n,7,0,t.owner),e(n,9,0,!t.owner),e(n,14,0,t.room.packs),e(n,19,0,t.players)}),(function(e,n){e(n,3,0,n.component.roomCode)}))}function _(e){return l.Ib(0,[(e()(),l.pb(0,0,null,null,6,"ion-header",[],null,null,null,o.B,o.h)),l.ob(1,49152,null,0,i.A,[l.h,l.k,l.x],null,null),(e()(),l.pb(2,0,null,0,4,"ion-toolbar",[],null,null,null,o.N,o.t)),l.ob(3,49152,null,0,i.yb,[l.h,l.k,l.x],null,null),(e()(),l.pb(4,0,null,0,2,"ion-title",[],null,null,null,o.L,o.r)),l.ob(5,49152,null,0,i.wb,[l.h,l.k,l.x],null,null),(e()(),l.Hb(-1,0,["lobby"])),(e()(),l.pb(7,0,null,null,3,"ion-content",[],null,null,null,o.z,o.f)),l.ob(8,49152,null,0,i.t,[l.h,l.k,l.x],null,null),(e()(),l.eb(16777216,null,0,1,null,S)),l.ob(10,16384,null,0,s.j,[l.M,l.J],{ngIf:[0,"ngIf"]},null)],(function(e,n){e(n,10,0,null!=n.component.room)}),null)}var C=l.lb("app-lobby",d,(function(e){return l.Ib(0,[(e()(),l.pb(0,0,null,null,1,"app-lobby",[],null,null,null,_,k)),l.ob(1,114688,null,0,d,[h.a,m.a,f.a,c.c,c.b,g.m,g.a,i.a,i.Jb,v.a],null,null)],(function(e,n){e(n,1,0)}),null)}),{},{},[]),z=t("s7LF"),G=function e(){_classCallCheck(this,e)};t.d(n,"LobbyPageModuleNgFactory",(function(){return L}));var L=l.mb(r,[],(function(e){return l.yb([l.zb(512,l.j,l.X,[[8,[u.a,C]],[3,l.j],l.v]),l.zb(4608,s.l,s.k,[l.s,[2,s.w]]),l.zb(4608,z.t,z.t,[]),l.zb(4608,i.b,i.b,[l.x,l.g]),l.zb(4608,i.Cb,i.Cb,[i.b,l.j,l.p]),l.zb(4608,i.Fb,i.Fb,[i.b,l.j,l.p]),l.zb(1073742336,s.b,s.b,[]),l.zb(1073742336,z.s,z.s,[]),l.zb(1073742336,z.i,z.i,[]),l.zb(1073742336,i.Ab,i.Ab,[]),l.zb(1073742336,g.o,g.o,[[2,g.t],[2,g.m]]),l.zb(1073742336,G,G,[]),l.zb(1073742336,r,r,[]),l.zb(1024,g.k,(function(){return[[{path:"",component:d}]]}),[])])}))}}]);