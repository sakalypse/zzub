(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{DShy:function(l,n,e){"use strict";e.r(n);var t=e("8Y7J");class u{}var o=e("pMnS"),i=e("MKJQ"),r=e("sZkV"),s=e("SVse"),a=e("mrSG"),b=e("IheW"),h=e("qXBG"),c=e("AytR"),d=e("VdwR"),m=e("qfBg"),g=e("B68i");class p{constructor(l,n,e,t,u,o,i,r,s,a){this.authService=l,this.gameService=n,this.userService=e,this.http=t,this.router=o,this.activatedRoute=i,this.alertController=r,this.toastController=s,this.socket=a,this.API_URL=c.a.API_URL_DEV,this.http=new b.c(u),i.params.subscribe(l=>{this.init()})}ngOnInit(){}init(){return a.__awaiter(this,void 0,void 0,(function*(){this.userId=yield this.authService.getLoggedUser().userId,this.roomCode=this.activatedRoute.snapshot.paramMap.get("code"),this.room=yield this.gameService.getGameByCode(this.roomCode),this.players=this.room.players,this.owner=this.room.owner.userId==this.userId,this.room.players.some(l=>l.userId==this.userId)||(yield this.gameService.addUserToGame(this.room.gameId,this.userId),this.players.push(yield this.userService.getSafeInfoUser(this.userId))),this.socket.emit("joinLobby",this.authService.getLoggedUser().userId,this.roomCode),this.socket.fromEvent("joinLobby").subscribe(l=>a.__awaiter(this,void 0,void 0,(function*(){let n=yield this.userService.getSafeInfoUser(l);this.players.some(l=>l.userId==n.userId)||this.players.push(n)}))),this.socket.fromEvent("quitGame").subscribe(l=>a.__awaiter(this,void 0,void 0,(function*(){this.players=this.players.filter(n=>n.userId!==l)}))),this.socket.fromEvent("killGame").subscribe(l=>a.__awaiter(this,void 0,void 0,(function*(){this.authService.getLoggedUser().role==g.a.guest&&(yield this.userService.deleteGuest(this.authService.getLoggedUser().userId),this.authService.clearStorage()),this.router.navigate(["/homepage/"])}))),this.socket.fromEvent("startGame").subscribe(l=>a.__awaiter(this,void 0,void 0,(function*(){this.router.navigateByUrl("/game/"+this.roomCode)})))}))}exitRoom(){return a.__awaiter(this,void 0,void 0,(function*(){yield this.gameService.removeUserToGame(this.room.gameId,this.userId),this.authService.getLoggedUser().role==g.a.guest&&(yield this.userService.deleteGuest(this.authService.getLoggedUser().userId),this.authService.clearStorage()),this.socket.emit("quitGame",this.userId,this.roomCode),this.router.navigate(["/homepage/"])}))}deleteRoom(){return a.__awaiter(this,void 0,void 0,(function*(){yield this.gameService.deleteGame(this.room.gameId),this.socket.emit("killGame",this.roomCode),this.router.navigate(["/homepage/"])}))}startRoom(){return a.__awaiter(this,void 0,void 0,(function*(){yield this.gameService.startGame(this.room.gameId),this.socket.emit("startGame",this.roomCode),this.router.navigateByUrl("/game/"+this.roomCode)}))}}var v=e("iInd"),f=e("RH9n"),I=t.nb({encapsulation:0,styles:[[""]],data:{}});function y(l){return t.Ib(0,[(l()(),t.pb(0,0,null,null,1,"button",[],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.startRoom()&&t),t}),null,null)),(l()(),t.Hb(-1,null,["Start room"]))],null,null)}function k(l){return t.Ib(0,[(l()(),t.pb(0,0,null,null,1,"button",[],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.deleteRoom()&&t),t}),null,null)),(l()(),t.Hb(-1,null,["Delete room"]))],null,null)}function S(l){return t.Ib(0,[(l()(),t.pb(0,0,null,null,1,"button",[],null,[[null,"click"]],(function(l,n,e){var t=!0;return"click"===n&&(t=!1!==l.component.exitRoom()&&t),t}),null,null)),(l()(),t.Hb(-1,null,["Exit room"]))],null,null)}function w(l){return t.Ib(0,[(l()(),t.pb(0,0,null,null,2,"div",[],null,null,null,null,null)),(l()(),t.pb(1,0,null,null,1,"div",[],null,null,null,null,null)),(l()(),t.Hb(2,null,["",""]))],null,(function(l,n){l(n,2,0,n.context.$implicit.name)}))}function _(l){return t.Ib(0,[(l()(),t.pb(0,0,null,null,4,"ion-card",[],null,null,null,i.x,i.c)),t.ob(1,49152,null,0,r.l,[t.h,t.k,t.x],null,null),(l()(),t.pb(2,0,null,0,2,"ion-card-content",[],null,null,null,i.w,i.d)),t.ob(3,49152,null,0,r.m,[t.h,t.k,t.x],null,null),(l()(),t.Hb(4,0,[" "," "]))],null,(function(l,n){l(n,4,0,n.context.$implicit.username)}))}function z(l){return t.Ib(0,[(l()(),t.pb(0,0,null,null,19,"ion-content",[],null,null,null,i.z,i.f)),t.ob(1,49152,null,0,r.t,[t.h,t.k,t.x],null,null),(l()(),t.pb(2,0,null,0,1,"div",[],null,null,null,null,null)),(l()(),t.Hb(3,null,["Lobby : ",""])),(l()(),t.eb(16777216,null,0,1,null,y)),t.ob(5,16384,null,0,s.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(l()(),t.eb(16777216,null,0,1,null,k)),t.ob(7,16384,null,0,s.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(l()(),t.eb(16777216,null,0,1,null,S)),t.ob(9,16384,null,0,s.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null),(l()(),t.pb(10,0,null,0,2,"div",[],null,null,null,null,null)),(l()(),t.pb(11,0,null,null,0,"br",[],null,null,null,null,null)),(l()(),t.Hb(-1,null,["Packs :"])),(l()(),t.eb(16777216,null,0,1,null,w)),t.ob(14,278528,null,0,s.i,[t.M,t.J,t.q],{ngForOf:[0,"ngForOf"]},null),(l()(),t.pb(15,0,null,0,2,"div",[],null,null,null,null,null)),(l()(),t.pb(16,0,null,null,0,"br",[],null,null,null,null,null)),(l()(),t.Hb(-1,null,["Players :"])),(l()(),t.eb(16777216,null,0,1,null,_)),t.ob(19,278528,null,0,s.i,[t.M,t.J,t.q],{ngForOf:[0,"ngForOf"]},null)],(function(l,n){var e=n.component;l(n,5,0,e.owner&&e.players.length>=1),l(n,7,0,e.owner),l(n,9,0,!e.owner),l(n,14,0,e.room.packs),l(n,19,0,e.players)}),(function(l,n){l(n,3,0,n.component.roomCode)}))}function G(l){return t.Ib(0,[(l()(),t.pb(0,0,null,null,6,"ion-header",[],null,null,null,i.B,i.h)),t.ob(1,49152,null,0,r.A,[t.h,t.k,t.x],null,null),(l()(),t.pb(2,0,null,0,4,"ion-toolbar",[],null,null,null,i.N,i.t)),t.ob(3,49152,null,0,r.yb,[t.h,t.k,t.x],null,null),(l()(),t.pb(4,0,null,0,2,"ion-title",[],null,null,null,i.L,i.r)),t.ob(5,49152,null,0,r.wb,[t.h,t.k,t.x],null,null),(l()(),t.Hb(-1,0,["lobby"])),(l()(),t.pb(7,0,null,null,3,"ion-content",[],null,null,null,i.z,i.f)),t.ob(8,49152,null,0,r.t,[t.h,t.k,t.x],null,null),(l()(),t.eb(16777216,null,0,1,null,z)),t.ob(10,16384,null,0,s.j,[t.M,t.J],{ngIf:[0,"ngIf"]},null)],(function(l,n){l(n,10,0,null!=n.component.room)}),null)}function x(l){return t.Ib(0,[(l()(),t.pb(0,0,null,null,1,"app-lobby",[],null,null,null,G,I)),t.ob(1,114688,null,0,p,[h.a,d.a,m.a,b.c,b.b,v.m,v.a,r.a,r.Jb,f.a],null,null)],(function(l,n){l(n,1,0)}),null)}var C=t.lb("app-lobby",p,x,{},{},[]),L=e("s7LF");class U{}e.d(n,"LobbyPageModuleNgFactory",(function(){return R}));var R=t.mb(u,[],(function(l){return t.yb([t.zb(512,t.j,t.X,[[8,[o.a,C]],[3,t.j],t.v]),t.zb(4608,s.l,s.k,[t.s,[2,s.w]]),t.zb(4608,L.t,L.t,[]),t.zb(4608,r.b,r.b,[t.x,t.g]),t.zb(4608,r.Cb,r.Cb,[r.b,t.j,t.p]),t.zb(4608,r.Fb,r.Fb,[r.b,t.j,t.p]),t.zb(1073742336,s.b,s.b,[]),t.zb(1073742336,L.s,L.s,[]),t.zb(1073742336,L.i,L.i,[]),t.zb(1073742336,r.Ab,r.Ab,[]),t.zb(1073742336,v.o,v.o,[[2,v.t],[2,v.m]]),t.zb(1073742336,U,U,[]),t.zb(1073742336,u,u,[]),t.zb(1024,v.k,(function(){return[[{path:"",component:p}]]}),[])])}))}}]);